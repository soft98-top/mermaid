<!DOCTYPE html>
<html>
<head>
    <title>Monaco Editor Debug</title>
    <style>
        body { margin: 0; padding: 20px; }
        .debug-info { 
            background: #f0f0f0; 
            padding: 10px; 
            margin: 10px 0; 
            font-family: monospace; 
            font-size: 12px;
        }
        .editor-container { 
            height: 400px; 
            border: 2px solid red; 
            position: relative;
        }
    </style>
</head>
<body>
    <h2>Monaco Editor DOM Structure Debug</h2>
    <div class="debug-info" id="debug-output">Loading...</div>
    <div class="editor-container" id="editor-container"></div>

    <script>
        // 模拟检查Monaco编辑器DOM结构
        function analyzeMonacoStructure() {
            const container = document.getElementById('editor-container');
            
            // 创建模拟的Monaco编辑器结构
            container.innerHTML = `
                <div class="monaco-editor" style="height: 100%; position: relative;">
                    <div class="overflow-guard" style="position: relative; height: 100%;">
                        <div class="monaco-editor-background" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white;"></div>
                        <div class="monaco-scrollable-element" style="position: relative; height: 100%; overflow: hidden;">
                            <div class="lines-content" style="position: relative; background: transparent;">
                                <!-- 模拟很多行代码 -->
                                ${Array.from({length: 50}, (_, i) => `<div>Line ${i + 1}: Some code content here...</div>`).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // 分析结构
            const monacoEditor = container.querySelector('.monaco-editor');
            const background = container.querySelector('.monaco-editor-background');
            const linesContent = container.querySelector('.lines-content');
            const scrollableElement = container.querySelector('.monaco-scrollable-element');

            const analysis = {
                containerHeight: container.offsetHeight,
                monacoEditorHeight: monacoEditor?.offsetHeight,
                backgroundHeight: background?.offsetHeight,
                linesContentHeight: linesContent?.offsetHeight,
                scrollableHeight: scrollableElement?.offsetHeight,
                linesContentScrollHeight: linesContent?.scrollHeight
            };

            document.getElementById('debug-output').innerHTML = `
                <strong>Monaco Editor Structure Analysis:</strong><br>
                Container Height: ${analysis.containerHeight}px<br>
                Monaco Editor Height: ${analysis.monacoEditorHeight}px<br>
                Background Height: ${analysis.backgroundHeight}px<br>
                Lines Content Height: ${analysis.linesContentHeight}px<br>
                Lines Content Scroll Height: ${analysis.linesContentScrollHeight}px<br>
                Scrollable Element Height: ${analysis.scrollableHeight}px<br><br>
                
                <strong>Problem Analysis:</strong><br>
                - Background is fixed at container height (${analysis.backgroundHeight}px)<br>
                - Lines content actual height is ${analysis.linesContentHeight}px<br>
                - Lines content scroll height is ${analysis.linesContentScrollHeight}px<br>
                - When scrolling, background doesn't extend to cover all content<br><br>
                
                <strong>Solution:</strong><br>
                Background height should match lines-content scroll height, not container height
            `;
        }

        // 延迟执行分析
        setTimeout(analyzeMonacoStructure, 100);
    </script>
</body>
</html>